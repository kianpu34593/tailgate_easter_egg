<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Answer â†’ Reveal Invite Image</title>
  <style>
    :root {
      --bg: #0b0d12;
      --card: #12161f;
      --muted: #9aa3b2;
      --text: #e8ecf1;
      --accent: #6aa6ff;
      --accent-2: #7affc1;
      --ring: rgba(106, 166, 255, 0.35);
      --radius: 18px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(1200px 800px at 20% -20%, rgba(122,255,193,0.08), transparent 40%),
                  radial-gradient(1000px 700px at 120% 20%, rgba(106,166,255,0.10), transparent 40%),
                  var(--bg);
      color: var(--text);
      min-height: 100svh; display: grid; place-items: center; padding: 24px;
    }
    .card {
      width: 100%; max-width: 720px; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.08); border-radius: var(--radius);
      box-shadow: 0 10px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.04);
      overflow: hidden; position: relative;
    }
    .header {
      padding: 22px 24px; border-bottom: 1px solid rgba(255,255,255,0.08);
      display: flex; align-items: center; gap: 12px;
      background: linear-gradient(180deg, rgba(122,255,193,0.06), rgba(0,0,0,0));
    }
    .header .dot { width: 10px; height: 10px; border-radius: 999px; background: var(--accent-2); box-shadow: 0 0 16px var(--accent-2); }
    .title { font-size: 18px; font-weight: 700; letter-spacing: 0.2px; }

    form { padding: 24px; display: grid; gap: 14px; }
    label { font-size: 14px; color: var(--muted); }
    .row { display: grid; grid-template-columns: 1fr auto; gap: 10px; }
    input[type="text"] {
      width: 100%; font-size: 16px; padding: 12px 14px; border-radius: 12px; outline: none;
      border: 1px solid rgba(255,255,255,0.12); background: #0f131b; color: var(--text);
      transition: border-color .2s, box-shadow .2s;
    }
    input[type="text"]:focus { border-color: var(--accent); box-shadow: 0 0 0 6px var(--ring); }

    button {
      appearance: none; border: none; cursor: pointer; padding: 12px 16px; border-radius: 12px;
      font-weight: 700; letter-spacing: .2px; font-size: 15px;
      background: linear-gradient(180deg, var(--accent), #447eea); color: #051022;
      box-shadow: 0 10px 20px rgba(68,126,234,.35), inset 0 1px 0 rgba(255,255,255,.35);
      transition: transform .06s ease-in-out, filter .2s;
    }
    button:hover { filter: brightness(1.05); }
    button:active { transform: translateY(1px); }
    button:disabled { opacity: .5; cursor: not-allowed; }

    .hint { font-size: 13px; color: var(--muted); margin-top: -4px; }
    .err { color: #ffb4b4; font-size: 13px; min-height: 1.2em; }

    .reveal {
      display: none; padding: 0 24px 24px 24px;
    }
    .reveal.show { display: block; }
    .reveal .panel {
      margin-top: 12px; border: 1px solid rgba(255,255,255,0.10); border-radius: 14px; overflow: hidden;
      background: #0e1420;
    }
    .reveal .panel header { padding: 14px 16px; font-weight: 700; font-size: 15px; background: rgba(122,255,193,0.08); }
    .reveal .panel .content { padding: 12px; }
    .reveal img { width: 100%; height: auto; border-radius: 10px; display: block; opacity: 0; transform: translateY(6px); transition: opacity .5s ease, transform .5s ease; }
    .reveal.show img { opacity: 1; transform: translateY(0); }

    .footer { padding: 12px 16px 18px; display: flex; justify-content: flex-end; gap: 8px; border-top: 1px solid rgba(255,255,255,0.08); }
    .link-btn { background: transparent; color: var(--accent); border: 1px solid rgba(255,255,255,0.16); }

    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,1px,1px); white-space: nowrap; border: 0; }

    .notice { padding: 12px 16px; font-size: 13px; color: var(--muted); border-top: 1px dashed rgba(255,255,255,0.12); }
  </style>
</head>
<body>
  <noscript>
    <div class="card" role="alert" aria-live="polite"><div class="header"><div class="dot"></div><div class="title">JavaScript required</div></div><div style="padding:18px 24px">This page needs JavaScript enabled to reveal the invite image after answering.</div></div>
  </noscript>

  <main class="card" aria-labelledby="title">
    <div class="header">
      <div class="dot" aria-hidden="true"></div>
      <h1 id="title" class="title">Do you know Kian?</h1>
    </div>

    <!--
      Configuration (edit these in the HTML or set via data-* attributes):
      - requireCorrectAnswer: set to true to require a specific answer; false to reveal on any answer
      - correctAnswer: the exact match (case-insensitive, trimmed) when requireCorrectAnswer=true
      - inviteImageSrc: URL of the image to reveal
      - inviteAlt: alt text for accessibility
    -->

    <form id="qa-form"
          data-require-correct="true"
          data-invite-src="img/invitation.pdf"
          data-invite-alt="Event invite">

      <label for="questionSelect">Choose one question to answer</label>
      <div class="row">
        <select id="questionSelect" name="question" aria-describedby="hint"></select>
      </div>

      <div id="answerWrap" class="row" style="margin-top:8px;">
        <input id="answer" name="answer" type="text" placeholder="Type your answerâ€¦" autocomplete="off" required aria-describedby="hint" />
        <button id="submitBtn" type="submit" disabled>Submit</button>
      </div>

      <div id="hint" class="hint">Pick a question from the dropdown, answer it, and the easter egg will appear.</div>
      <div id="err" class="err" role="alert" aria-live="polite"></div>
    </form>

    <section id="reveal" class="reveal" aria-live="polite">
      <div class="panel">
        <header>You're in! ðŸŽ‰</header>
        <div class="content">
          <img id="inviteImg" src="" alt="" loading="lazy" width="1280" height="720" />
        </div>
      </div>
    </section>

    <div class="footer">
      <button type="button" class="link-btn" id="resetBtn" aria-label="Reset and answer again">Reset</button>
      <button type="button" class="link-btn" id="copyLinkBtn" aria-label="Copy invite image link">Copy invite link</button>
    </div>
  </main>

  <script>
    (function () {
      // ===== Configurable questions =====
      // type: 'text' (free text) or 'select' (dropdown answers)
      // acceptedAnswers: [] means any non-empty answer is accepted
      // For 'select', define options: ['A','B','C'] and (optionally) acceptedAnswers to restrict correct ones
      const QUESTIONS = [
        { id: 'q1', label: 'What is Kian\'s last name?', type: 'text', acceptedAnswers: ['pu','Pu','PU'] },
        { id: 'q2', label: 'What sports has Kian been playing for the last 6 months?', type: 'text', acceptedAnswers: ['Soccer','soccer','SOCCCER'] },
        { id: 'q3', label: 'Who is Kian\'s PI?', type: 'select', type: 'text', acceptedAnswers: ['Venkat','Venkat Viswanathan','Prof. Venkat Viswanathan'] },
        { id: 'q4', label: 'What is Kian\'s go-to phrase?', type: 'text', acceptedAnswers: ['Let\'s go','LET\'S GO','Letgo','Let\'s Go'] }
      ];

      const form = document.getElementById('qa-form');
      const requireCorrectGlobal = (form.dataset.requireCorrect || 'true').toLowerCase() === 'true';
      const inviteSrc = form.dataset.inviteSrc || '';
      const inviteAlt = form.dataset.inviteAlt || 'Invite image';

      const questionSelect = document.getElementById('questionSelect');
      const answerWrap = document.getElementById('answerWrap');
      const textInput = document.getElementById('answer');
      const submitBtn = document.getElementById('submitBtn');
      const err = document.getElementById('err');
      const hint = document.getElementById('hint');
      const reveal = document.getElementById('reveal');
      const img = document.getElementById('inviteImg');
      const resetBtn = document.getElementById('resetBtn');
      const copyBtn = document.getElementById('copyLinkBtn');

      // Runtime state
      let currentAnswerEl = textInput; // can be input or a generated select

      // Populate question dropdown
      function populateQuestions() {
        questionSelect.innerHTML = '';
        QUESTIONS.forEach((q, idx) => {
          const opt = document.createElement('option');
          opt.value = q.id;
          opt.textContent = q.label;
          if (idx === 0) opt.selected = true;
          questionSelect.appendChild(opt);
        });
        renderAnswerField(QUESTIONS[0]);
      }

      function clearAnswerField() {
        if (currentAnswerEl && currentAnswerEl !== textInput) {
          // remove any injected select
          currentAnswerEl.remove();
          currentAnswerEl = textInput;
        }
        textInput.value = '';
        submitBtn.disabled = true;
      }

      function renderAnswerField(q) {
        clearAnswerField();
        err.textContent = '';
        textInput.setAttribute('aria-invalid', 'false');

        if (q.type === 'select') {
          // Create/select element with options
          const sel = document.createElement('select');
          sel.id = 'answerSelect';
          sel.setAttribute('aria-describedby', 'hint');
          sel.required = true;
          // Placeholder option
          const ph = document.createElement('option');
          ph.value = '';
          ph.textContent = 'Choose an optionâ€¦';
          ph.disabled = true; ph.selected = true;
          sel.appendChild(ph);
          (q.options || []).forEach(o => {
            const opt = document.createElement('option');
            opt.value = String(o);
            opt.textContent = String(o);
            sel.appendChild(opt);
          });
          // Swap into the UI (replace text input)
          answerWrap.insertBefore(sel, submitBtn);
          textInput.style.display = 'none';
          currentAnswerEl = sel;
          hint.textContent = 'Pick one option to continue.';

          sel.addEventListener('change', () => {
            submitBtn.disabled = (sel.value === '');
            if (err.textContent) err.textContent = '';
          });
        } else {
          // Free-text input
          textInput.style.display = '';
          textInput.placeholder = 'Type your answerâ€¦';
          currentAnswerEl = textInput;
          hint.textContent = 'Type an answer (not case sensitive for exact checks).';

          textInput.addEventListener('input', () => {
            submitBtn.disabled = textInput.value.trim().length === 0;
            if (err.textContent) err.textContent = '';
          }, { once: true });
        }
      }

      function getCurrentQuestion() {
        const id = questionSelect.value;
        return QUESTIONS.find(q => q.id === id) || QUESTIONS[0];
      }

      function isAnswerAccepted(q, answerRaw) {
        const val = (answerRaw || '').trim();
        if (!val) return false; // require non-empty
        // If acceptedAnswers is empty OR global requireCorrect is false, accept any non-empty
        const list = Array.isArray(q.acceptedAnswers) ? q.acceptedAnswers : [];
        if (list.length === 0 || !requireCorrectGlobal) return true;
        return list.map(s => String(s).trim().toLowerCase()).includes(val.toLowerCase());
      }

      // Initialize
      populateQuestions();

      // Respond to question change
      questionSelect.addEventListener('change', () => {
        const q = getCurrentQuestion();
        renderAnswerField(q);
      });

      // Handle submit
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const q = getCurrentQuestion();
        const answer = (currentAnswerEl.tagName.toLowerCase() === 'select')
          ? currentAnswerEl.value
          : currentAnswerEl.value;

        if (!isAnswerAccepted(q, answer)) {
          err.textContent = 'That doesn\'t look right. Try again!';
          currentAnswerEl.setAttribute('aria-invalid', 'true');
          return;
        }

        // Reveal the invite image
        img.src = inviteSrc;
        img.alt = inviteAlt;
        reveal.classList.add('show');
        form.style.display = 'none';
      });

      // Footer buttons
      resetBtn.addEventListener('click', () => {
        // Reset UI to ask again
        form.reset();
        // Remove any injected select and restore text input
        const sel = document.getElementById('answerSelect');
        if (sel) sel.remove();
        textInput.style.display = '';
        textInput.value = '';
        submitBtn.disabled = true;
        err.textContent = '';
        form.style.display = '';
        reveal.classList.remove('show');
        img.removeAttribute('src');
        img.removeAttribute('alt');
        populateQuestions();
        questionSelect.focus();
      });

      copyBtn.addEventListener('click', async () => {
        try {
          if (!inviteSrc) return;
          await navigator.clipboard.writeText(inviteSrc);
          copyBtn.textContent = 'Copied!';
          setTimeout(() => (copyBtn.textContent = 'Copy invite link'), 1400);
        } catch (e) {
          alert('Could not copy automatically. Longâ€‘press or rightâ€‘click the image to copy the link.');
        }
      });
    })();
  </script>
</body>
</html>
